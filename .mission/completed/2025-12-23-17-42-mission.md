# MISSION: Card List Merging Function

**Track**: 2 (Standard)  
**Type**: WET  
**Status**: completed  
**Created**: 2025-12-23T17:23:37.869-05:00  
**Completed**: 2025-12-23T17:42:16.976-05:00

## INTENT
Create a function to merge two lists of cards where cards with the same Header are merged together. For KeyValue entries, deduplicate by Key. For string entries, skip merging. Use the mergeTemplateWithUserData algorithm pattern, preserving user data while incorporating template updates.

## SCOPE
- `internal/utils/merge.go` - New card merging function
- `internal/utils/merge_test.go` - Test coverage for merging logic

## PLAN
- [x] Create `internal/utils/` directory if it doesn't exist
- [x] Implement `MergeCardLists(target, source []Card) []Card` function
- [x] Merge cards with same Header (combine their content)
- [x] Deduplicate KeyValue entries by Key within merged cards
- [x] Skip merging for string entries (preserve as-is)
- [x] Adapt mergeTemplateWithUserData algorithm pattern for card structures
- [x] Create comprehensive test cases covering merge scenarios
- [x] Test edge cases: empty lists, duplicate headers, mixed KeyValue/string content

## VERIFICATION
```bash
go test ./internal/utils/... -v
```
**Status**: PASSED - All tests pass including deterministic behavior fix

## EXECUTION INSTRUCTIONS
This is a WET mission - allow duplication to explore the card merging domain. Focus on getting a working implementation first, then optimize. The AI should implement the merging function using the existing mergeTemplateWithUserData pattern as reference, adapting it for card list structures while ensuring no data loss and proper deduplication.

## COMPLETION SUMMARY
- Successfully implemented card list merging functionality
- Fixed non-deterministic test behavior by maintaining key insertion order
- All verification tests pass consistently
- Files created: internal/utils/merge.go, internal/utils/merge_test.go
